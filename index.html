<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>

  <title>kstrauser/tablefactory @ GitHub</title>

  <style type="text/css">
    body {
      margin-top: 1.0em;
      background-color: white;
      font-family: Helvetica,Arial,FreeSans;
      color: #002;
    }
    #container {
      margin: 0 auto;
      width: 700px;
    }
    h1 { font-size: 3.8em; color: #008; margin-bottom: 3px; }
    h1 .small { font-size: 0.4em; }
    h1 a { text-decoration: none }
    h2 { font-size: 1.5em; color: #008; }
    h3 { text-align: center; color: #008; }
    a { color: #008; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
    pre { background: #000; color: #fff; padding: 15px;}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .footer { text-align:center; padding-top:30px; font-style: italic; }
  </style>
</head>

<body>
  <a href="http://github.com/kstrauser/tablefactory"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>

  <div id="container">

    <div class="download">
      <a href="http://github.com/kstrauser/tablefactory/zipball/master">
        <img border="0" width="90" src="http://github.com/images/modules/download/zip.png"></a>
      <a href="http://github.com/kstrauser/tablefactory/tarball/master">
        <img border="0" width="90" src="http://github.com/images/modules/download/tar.png"></a>
    </div>

    <h1><a href="http://github.com/kstrauser/tablefactory">TableFactory</a>
      <span class="small">by <a href="http://github.com/kstrauser">kstrauser</a></span></h1>

    <div class="description">
      Easily create HTML, spreadsheet, or PDF tables from common Python data sources
    </div>

    <p>TableFactory is a simple API for creating tables in popular formats. It acts as a wrapper around other popular Python report generators and handles all the tedious, boilerplate problems of extracting columns from input data, creating the layout, applying formatting to cells, etc.
</p>

<h2>Why?</h2>

<p>I maintain an internal web application with many reports for our
customers. After writing the code to generate a report's data, I'd have to
make custom backends to write that data out in each of several formats that
different customers might want. If someone asked me to add a new column to a
report, I'd have to add it separately to each of the output types.  That got
old quickly.</p>

<p>TableFactory is my solution to the problem. It lets me spend my efforts
on making efficient, useful reports instead of on the boring, repetitive
process of formatting them.</p>

<h2>Dependencies</h2>
<p>HTML tables are made using only standard Python modules.</p>
<p>Spreadsheets are made with <tt>xlwt</tt> (<a href="http://pypi.python.org/pypi/xlwt">http://pypi.python.org/pypi/xlwt</a>).</p>
<p>PDFs are made with <tt>ReportLab</tt> (<a href="http://www.reportlab.com/software/opensource/">http://www.reportlab.com/software/opensource/</a>).</p>

<h2>Examples and Screenshots</h2>

<p>All of the images below were taken from the built-in example/test function. It creates a list of dicts representing fake invoices, then uses them to create a table in each of the output formats.</p>

<pre>
rows = [...list of dicts, SQLAlchemy row objects, or just
        about anything else with columns that can be accessed
        by name or attribute...]
</pre>

<p>First, I made a "row specification" with three columns for the invoice number, a customer's name, and an invoice amount:</p>

<pre>
invoicerow = RowSpec(ColumnSpec('invoiceid', 'Invoice #'),
                     ColumnSpec('name', 'Customer Name'),
                     ColumnSpec('amount', 'Total', money=True))
</pre>

<p>Next, I used the <tt>invoicerow</tt> object to turn the list of invoice
rows into a list of TableFactory's "TableRow" objects:</p>

<pre>lines = invoicerow.makeall(rows)</pre>

<p>Finally, I created each of the tables:</p>

<h3>HTML</h3>
<pre>
HTMLTable('Invoices by Customer',
          'Amount of each invoice, sorted by invoiceid',
          headers=invoicerow).render(lines)
</pre>
<a href="images/invoicehtml.png"><img src="images/invoicehtml.png" width="162" height="269"></a>

<h3>Excel</h3>
<pre>
SpreadsheetTable('Invoices by Customer',
                 'Amount of each invoice, sorted by invoiceid',
                 headers=invoicerow).render(lines)
</pre>
<a href="images/invoicexls.png"><img src="images/invoicexls.png" width="191" height="284"></a>

<h3>PDF</h3>
<pre>
PDFTable('Invoices by Customer',
         'Amount of each invoice, sorted by invoiceid',
         headers=invoicerow).render(lines)
</pre>
<a href="images/invoicepdf.png"><img src="images/invoicepdf.png" width="350" height="198"></a>

<p>Notice that the only difference in creating the different types of tables
is in the name of the class used to make each one. They share the same
configuration and processed input data.</p>

<h2>Install</h2>
<p>Coming soon: PyPI, easy_install, pip, etc. Those aren't ready yet, though. To get started now, download TableFactory.py from <a href="https://github.com/kstrauser/tablefactory/blob/master/TableFactory.py">https://github.com/kstrauser/tablefactory/blob/master/TableFactory.py</a> and copy it to somewhere in your Python path. For example, <tt>/usr/local/lib/python2.6/site-packages</tt> might be a reasonable location on a Ubuntu system.</p>
<h2>License</h2>
<p>TableFactory is available under the permissive MIT License.</p>
<h2>Authors</h2>
<p>Kirk Strauser (kirk@strauser.com)<br/><br/>      </p>
<h2>Contact</h2>
<p>Kirk Strauser (kirk@strauser.com)<br/>      </p>


    <h2>Download</h2>
    <p>
      You can download this project in either
      <a href="http://github.com/kstrauser/tablefactory/zipball/master">zip</a> or
      <a href="http://github.com/kstrauser/tablefactory/tarball/master">tar</a> formats.
    </p>
    <p>You can also clone the project with <a href="http://git-scm.com">Git</a>
      by running:
      <pre>$ git clone git://github.com/kstrauser/tablefactory</pre>
    </p>

    <div class="footer">
      get the source code on GitHub : <a href="http://github.com/kstrauser/tablefactory">kstrauser/tablefactory</a>
    </div>

  </div>

  <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-21560863-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
